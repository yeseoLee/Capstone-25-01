# 노드 서브셋 기능 사용 가이드

STGAN 모델에서 메모리 사용량과 작업 시간을 줄이기 위해 일부 노드만 선택해서 사용할 수 있는 기능이 추가되었습니다. 이 기능은 대규모 그래프에서 특히 유용합니다.

## 기능 개요

노드 서브셋 기능은 전체 노드 중 일부만 선택하여 학습 및 추론을 수행함으로써 다음과 같은 이점을 제공합니다:

- **메모리 사용량 감소**: 처리할 노드 수가 줄어들어 메모리 사용량이 감소합니다.
- **작업 시간 단축**: 처리할 데이터 양이 줄어들어 학습 및 추론 시간이 단축됩니다.
- **특정 노드 집중 분석**: 관심 있는 특정 노드들만 선택하여 분석할 수 있습니다.

## 사용 방법

노드 서브셋 기능은 다음 세 가지 명령줄 인수를 통해 제어할 수 있습니다:

### 1. 노드 서브셋 활성화

```bash
--use-node-subset
```

이 옵션을 사용하면 노드 서브셋 기능이 활성화됩니다.

### 2. 노드 비율 지정

```bash
--node-ratio 0.3
```

전체 노드 중 랜덤하게 선택할 노드의 비율을 지정합니다. 0.0~1.0 사이의 값을 사용하며, 기본값은 0.5입니다.

### 3. 특정 노드 목록 지정

```bash
--node-list "0,1,5,10,15,20"
```

사용할 특정 노드의 인덱스를 쉼표로 구분하여 지정합니다. 이 옵션을 사용하면 `--node-ratio` 옵션은 무시됩니다.

## 실행 예시

### 랜덤하게 30%의 노드만 사용

```bash
python main.py --use-node-subset --node-ratio 0.3
```

### 특정 노드만 사용

```bash
python main.py --use-node-subset --node-list "0,5,10,15,20,25,30"
```

### 기존 방식대로 모든 노드 사용

```bash
python main.py
```

## 결과 파일

노드 서브셋 기능을 사용하면 다음과 같은 결과 파일이 생성됩니다:

1. **선택된 노드 정보 파일**: 선택된 노드의 인덱스 목록이 저장됩니다.
2. **정규화 정보 파일**: 사용된 데이터의 정규화 범위 정보가 저장됩니다.
3. **모델 체크포인트**: 체크포인트에 노드 서브셋 정보가 포함됩니다.
4. **메타데이터 파일**: 노드 서브셋 정보와 함께 학습/테스트 설정이 저장됩니다.
5. **로그 파일**: 메모리 사용량, 실행 시간 등의 성능 정보가 기록됩니다.

## 성능 모니터링

노드 서브셋 기능을 사용하면 다음과 같은 성능 정보가 로그에 출력됩니다:

- 실험 시작 시 초기 메모리 사용량
- 데이터셋 로드 후 메모리 사용량
- 실험 완료 후 총 실행 시간
- 실험 완료 후 최종 메모리 사용량
- 메모리 증가량

이 정보를 통해 노드 서브셋 사용 전후의 성능 차이를 확인할 수 있습니다.

## 주의사항

- 노드 수가 줄어들면 그래프의 연결성이 변할 수 있으므로, 학습 결과에도 영향을 미칠 수 있습니다.
- 중요한 노드가 제외될 경우 모델의 예측 성능이 저하될 수 있습니다.
- 훈련과 테스트 시 동일한 노드 서브셋을 사용하는 것이 중요합니다. 테스트 시 모델에서 사용된 노드 정보가 자동으로 로드됩니다.
- 최적의 노드 비율은 데이터셋 특성과 사용 가능한 컴퓨팅 자원에 따라 다르므로, 실험을 통해 적절한 값을 찾는 것이 좋습니다. 